<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script type="module" src='../../../element.js?load&expose=E'></script>
    <link rel="stylesheet" href="../../style.css">
    <meta is="e-data" resource=":root|h1 > a" transform='{"title": $.innerHTML & " | Base37 Element"}'>
    <meta is="e-theme" resource="theme">
</head>
<body>
    <header>
        <h1><a href="">Pipes</a></h1>
    </header>
    <main>
        <p>View result at 
            <a href="https://public.requestbin.com/r/en3gc8hjsto6p">https://public.requestbin.com/r/en3gc8hjsto6p</a>
        </p>
        <fieldset>
            <meta is="e-pointer" resource="|button|!" target="||!notaclick">
            <meta id="pipe" is="e-pipe" via="" listen="test1|test2" content-type="json">

            <!--<meta is="e-pipe" name="socket" via="wss://example.com/" listen="message|data|data" content-type="json">
            <meta is="e-data" resource="|[name=socket]|_" >-->

            <!--<meta is="e-data" resource="||_notaclick" target="https://en3gc8hjsto6p.x.pipedream.net" options="method=POST">-->
            <!--<meta is="e-data" resource="||_notaclick" target=":|#pipe" apply="send">-->
            <!--<meta is="e-pipe" id="pipe" via="https://en3gc8hjsto6p.x.pipedream.net" options="method=POST">-->
            <legend>Pipe Test</legend>
            <label>
                <span>Name:</span>
                <input name="name" value="Test Pipe" readonly>
            </label>
            <label>
                <span>Number:</span>
                <input name="number" value="631" readonly>
            </label>
            <label>
                <span>Details:</span>
                <textarea name="details" rows="5" cols="50">Click the button to send</textarea>
            </label>
            <button>Send</button>
        </fieldset>
    </main>
    <footer>
        <meta is="e-content" resource="../../footer.html">
    </footer>
    <script> 
        document.querySelector('fieldset').addEventListener('notaclick', event => console.log(event)) 
        window.pipe = document.getElementById('pipe')

        window.setInterval(() => {
            pipe.resource.dispatchEvent(new CustomEvent('test1', {detail: `{"abc": ${Date.now()}}`}))
        }, 3700)

        //pipe.addEventListener('test2', event => console.log('line 55', event))

        window.setInterval(() => {
            console.log('line 58', E.getValue(pipe))
        }, 5000)

    </script>
</body>
</html>