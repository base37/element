<style></style>
<template><slot></slot></template>
<script>
    class extends `` {

        #shadow
        #source
        #layout

        constructor() {
            super()
        }

        static get observedAttributes() { return (super.observedAttributes || []).concat('source', 'layout', 'shadow') }

        async connectedCallback() {
            this._refresh()
            this.addEventListener('change', event => {
                const property = event?.detail?.property, value = event?.detail?.value, container = this.shadow ? this.shadowRoot : this
                if (!property) return
                if (this.hasAttribute('itemscope')) {
                    container.querySelectorAll(`[itemprop="${property}"]`)                    
                } else if (this.shadow) {

                } else {

                }
            })
        }

        _refresh() {
            const mergeData = this[this.#source] ?? this.eDataset, content = this.build(mergeData)
            if (typeof content === 'string') {
                this.innerHTML = content
            } else if (Array.isArray(content) || (content instanceof HTMLCollection)) {
                this.replaceChildren(...content)
            } else if (content instanceof Node) {
                this.replaceChildren(...[content])
            }            
        }

        set source(value) { this.#source = value }
        get source() { return this.#source }

        set layout(value) { this.#layout = value }
        get layout() { return this.#layout }

        set shadow(value) { this.#shadow = value }
        get shadow() { return this.#shadow }

    }
</script>
