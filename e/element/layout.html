<style></style>
<template><slot></slot></template>
<script>
    class extends `./abstract/pointer` {

    	constructor() {
    		super()
            Object.defineProperties(this, {
                _mode: {configurable: false, enumerable: false, writable: false, value: 'layout'}, 
                _contentType: {configurable: false, enumerable: false, writable: false, value: 'text/html'}
            })
    	}

		static get observedAttributes() { return (super.observedAttributes || []).concat() }

        _apply(result, target) {
            if (!Array.isArray(result)) result = [result]
            for (const [i, r] of result.entries()) {
                if (r instanceof Node) continue
                if (typeof r !== 'string') continue
                const t = document.createElement('template')
                template.innerHTML = r
                result[i] = template.content.cloneNode(true).children
            }
            result = result.flat()
            const template = document.createElement('template')
            template.content.replaceChildren(...result)
            let {from, use, into} = this.e.utils.parseObjectAttribute(this.apply ?? this.getAttribute('apply'))
            if (from) template.content.replaceChildren(...template.content.cloneNode(true).querySelectorAll(from))
            for (const t of target) {
                const fragment = template.content.cloneNode(true)                
                if (use && into) fragment.querySelector(into)?.replaceChildren(...target.querySelectorAll(use))
                t.replaceChildren(...fragment.children)
            }
        }

    }
</script>