<style></style>
<template></template>
<script>
    export default class extends `meta` {

        static get _flattenableProperties() {
            return (super._flattenableProperties || []).concat(Object.keys(document.location).filter(k => typeof document.location[k] !== 'function'))
        }

        constructor() {
            super()
            for (const [k, v] of Object.entries(document.location)) if (typeof document.location[k] !== 'function') {
                Object.defineProperty(this, k, { enumerable: true, get: () => document.location[k] })
                this.constructor._flattenableProperties.push(k)
            }
            Object.defineProperty(this, 'value', { enumerable: true, get: () => this.E.flatten(document.location) })
        }

        toString() { return document.location.toString() }

        connectedCallback() {
            window.addEventListener('hashchange', event => {
                this.dispatchEvent(new CustomEvent('change', { bubbles: true }))
            })
        }

        assign(url) { document.location.assign(url) }

        reload(forceGet) { document.location.reload(forceGet) }

        replace(url) { document.location.replace(url) }

        to(path) {
            if (path === true) window.location.reload()
            let url
            if (path && (typeof path === 'string')) {
                path = this.E.resolveVariables(path, this)
                if (!path) return
                window.location = this.E.resolveUrl(path, this)
            }
        }

    }
</script>